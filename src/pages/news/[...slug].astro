---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";

export async function getStaticPaths() {
  const posts = await getCollection("news");
  return posts
    .filter((post) => post.data.lang === "ja")
    .map((post) => ({
      params: { slug: post.id },
      props: post,
    }));
}

const post = Astro.props;
const { Content } = await render(post);
---

<Layout title={`${post.data.title} | News`} description={post.data.description}>
  <Header />

  <main>
    <article class="article-container">
      <header class="article-header container">
        <div class="meta">
          <time datetime={post.data.pubDate.toISOString()}>
            {post.data.pubDate.toISOString().slice(0, 10)}
          </time>
        </div>
        <h1>{post.data.title}</h1>
      </header>

      <div class="article-content container">
        <Content />
      </div>

      <div class="article-footer container">
        <a href="/news" class="btn btn-secondary">← News一覧へ戻る</a>
      </div>
    </article>
  </main>

  <Footer />
</Layout>

<style>
  .article-container {
    padding: 4rem 0 6rem;
    max-width: 800px;
    margin: 0 auto;
  }

  .article-header {
    margin-bottom: 3rem;
    text-align: center;
  }

  .article-header h1 {
    font-size: 2rem;
    line-height: 1.3;
    margin-top: 1rem;
  }

  .meta {
    color: var(--c-gray-500);
    font-family: monospace;
  }

  .article-content {
    line-height: 1.8;
    color: var(--c-gray-800);
    font-size: 1.05rem;
  }

  /* Markdown Content Styles */
  .article-content :global(h2) {
    font-size: 1.5rem;
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    color: var(--c-black);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--c-gray-200);
  }

  .article-content :global(h3) {
    font-size: 1.25rem;
    margin-top: 2rem;
    margin-bottom: 1rem;
    color: var(--c-black);
  }

  .article-content :global(p) {
    margin-bottom: 1.5rem;
  }

  .article-content :global(ul),
  .article-content :global(ol) {
    margin-bottom: 1.5rem;
    padding-left: 1.5rem;
  }

  .article-content :global(li) {
    margin-bottom: 0.5rem;
  }

  .article-content :global(a) {
    color: var(--c-accent);
    text-decoration: underline;
  }

  .article-footer {
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 1px solid var(--c-gray-200);
    text-align: center;
  }
</style>
